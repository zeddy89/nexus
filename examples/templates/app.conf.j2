# Application Configuration Template
#
# This is a Jinja2 template that Nexus renders with variables.
# Use with the template module:
#
#   - name: Deploy app config
#     template: templates/app.conf.j2
#     dest: /etc/myapp/config.ini
#     vars:
#       app_name: myapp
#       app_version: "1.0.0"
#       app_port: 8080
#       environment: production

[app]
name = {{ vars.app_name | default("myapp") }}
version = {{ vars.app_version | default("0.0.0") }}
port = {{ vars.app_port | default(8080) }}
environment = {{ vars.environment | default("development") }}

[logging]
level = {% if vars.environment == "production" %}WARN{% else %}DEBUG{% endif %}
format = json
output = /var/log/{{ vars.app_name }}/app.log

[server]
host = 0.0.0.0
port = {{ vars.app_port | default(8080) }}
workers = {% if vars.environment == "production" %}4{% else %}1{% endif %}

[database]
{% if vars.db_host is defined %}
host = {{ vars.db_host }}
port = {{ vars.db_port | default(5432) }}
name = {{ vars.db_name | default(vars.app_name) }}
{% else %}
# Database not configured
{% endif %}

# Generated by Nexus on {{ ansible_date_time.iso8601 | default("unknown") }}
